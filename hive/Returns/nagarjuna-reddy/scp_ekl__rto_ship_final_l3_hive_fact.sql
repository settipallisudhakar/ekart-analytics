INSERT OVERWRITE TABLE rto_ship_final_l3_hive_fact

SELECT A.vendor_tracking_id as vendor_tracking_id,
B.shipment_id as shipment_id,
lookupkey('facility_id',A.first_received_dh_id) as first_received_dh_id_key,
lookup_date(A.first_received_dh_time) as first_received_dh_date_key,
lookup_time(A.first_received_dh_time) as first_received_dh_time_key,
lookupkey('facility_id',A.first_received_pc_id) as first_received_pc_id_key,
lookup_date(A.first_received_pc_time) as first_received_pc_date_key,
lookup_time(A.first_received_pc_time) as first_received_pc_time_key,
lookupkey('facility_id',A.first_received_mh_id) as first_received_mh_id_key,
lookup_date(A.first_received_mh_time) as first_received_mh_date_key,
lookup_time(A.first_received_mh_time) as first_received_mh_time_key,
lookupkey('facility_id',A.second_received_mh_id) as second_received_mh_id_key,
lookup_date(A.second_received_mh_time) as second_received_mh_date_key,
lookup_time(A.second_received_mh_time) as second_received_mh_time_key,
lookupkey('facility_id',A.third_received_mh_id) as third_received_mh_id_key,
lookup_date(A.third_received_mh_time) as third_received_mh_date_key,
lookup_time(A.third_received_mh_time) as third_received_mh_time_key,
lookupkey('facility_id',A.fourth_received_mh_id) as fourth_received_mh_id_key,
lookup_date(A.fourth_received_mh_time) as fourth_received_mh_date_key,
lookup_time(A.fourth_received_mh_time) as fourth_received_mh_time_key,
lookupkey('facility_id',A.last_received_dh_id) as last_received_dh_id_key,
lookup_date(A.last_received_dh_time) as last_received_dh_date_key,
lookup_time(A.last_received_dh_time) as last_received_dh_time_key,
lookupkey('facility_id',A.last_received_mh_id) as last_received_mh_id_key,
lookup_date(A.last_received_mh_time) as last_received_mh_date_key,
lookup_time(A.last_received_mh_time) as last_received_mh_time_key,
lookupkey('facility_id',A.second_last_received_mh_id) as second_last_received_mh_id_key,
lookup_date(A.second_last_received_mh_time) as second_last_received_mh_date_key,
lookup_time(A.second_last_received_mh_time) as second_last_received_mh_time_key,
lookupkey('facility_id',A.first_cons_create_dh_id) as first_cons_create_dh_id_key,
lookupkey('facility_id',A.first_cons_create_dh_dest_id) as first_cons_create_dh_dest_id_key,
lookup_date(A.first_cons_create_dh_time) as first_cons_create_dh_date_key,
lookup_time(A.first_cons_create_dh_time) as first_cons_create_dh_time_key,
lookup_date(A.first_cons_create_dh_receive_time) as first_cons_create_dh_receive_date_key,
lookup_time(A.first_cons_create_dh_receive_time) as first_cons_create_dh_receive_time_key,
lookupkey('facility_id',A.first_cons_create_mh_id) as first_cons_create_mh_id_key,
lookupkey('facility_id',A.first_cons_create_mh_dest_id) as first_cons_create_mh_dest_id_key,
lookup_date(A.first_cons_create_mh_time) as first_cons_create_mh_date_key,
lookup_time(A.first_cons_create_mh_time) as first_cons_create_mh_time_key,
lookup_date(A.first_cons_create_mh_receive_time) as first_cons_create_mh_receive_date_key,
lookup_time(A.first_cons_create_mh_receive_time) as first_cons_create_mh_receive_time_key,
lookupkey('facility_id',A.second_cons_create_mh_id) as second_cons_create_mh_id_key,
lookupkey('facility_id',A.second_cons_create_mh_dest_id) as second_cons_create_mh_dest_id_key,
lookup_date(A.second_cons_create_mh_time) as second_cons_create_mh_date_key,
lookup_time(A.second_cons_create_mh_time) as second_cons_create_mh_time_key,
lookup_date(A.second_cons_create_mh_receive_time) as second_cons_create_mh_receive_date_key,
lookup_time(A.second_cons_create_mh_receive_time) as second_cons_create_mh_receive_time_key,
lookupkey('facility_id',A.third_cons_create_mh_id) as third_cons_create_mh_id_key,
lookupkey('facility_id',A.third_cons_create_mh_dest_id) as third_cons_create_mh_dest_id_key,
lookup_date(A.third_cons_create_mh_time) as third_cons_create_mh_date_key,
lookup_time(A.third_cons_create_mh_time) as third_cons_create_mh_time_key,
lookup_date(A.third_cons_create_mh_receive_time) as third_cons_create_mh_receive_date_key,
lookup_time(A.third_cons_create_mh_receive_time) as third_cons_create_mh_receive_time_key,
lookupkey('facility_id',A.last_cons_create_mh_id) as last_cons_create_mh_id_key,
lookupkey('facility_id',A.last_cons_create_mh_dest_id) as last_cons_create_mh_dest_id_key,
lookup_date(A.last_cons_create_mh_time) as last_cons_create_mh_date_key,
lookup_time(A.last_cons_create_mh_time) as last_cons_create_mh_time_key,
lookup_date(A.last_cons_create_mh_receive_time) as last_cons_create_mh_receive_date_key,
lookup_time(A.last_cons_create_mh_receive_time) as last_cons_create_mh_receive_time_key,
lookupkey('facility_id',A.sec_last_cons_create_mh_id) as sec_last_cons_create_mh_id_key,
lookupkey('facility_id',A.sec_last_cons_create_mh_dest_id) as sec_last_cons_create_mh_dest_id_key,
lookup_date(A.sec_last_cons_create_mh_time) as sec_last_cons_create_mh_date_key,
lookup_time(A.sec_last_cons_create_mh_time) as sec_last_cons_create_mh_time_key,
lookup_date(A.sec_last_cons_create_mh_receive_time) as sec_last_cons_create_mh_receive_date_key,
lookup_time(A.sec_last_cons_create_mh_receive_time) as sec_last_cons_create_mh_receive_time_key,
lookupkey('facility_id',A.last_cons_dest_dh_id) as last_cons_dest_dh_id_key,
lookupkey('facility_id',A.last_cons_dh_source_hub_id) as last_cons_dh_source_hub_id_key,
lookup_date(A.last_cons_dh_source_create_time) as last_cons_dh_source_create_date_key,
lookup_time(A.last_cons_dh_source_create_time) as last_cons_dh_source_create_time_key,
lookup_date(A.last_cons_dh_receive_time) as last_cons_dh_receive_date_key,
lookup_time(A.last_cons_dh_receive_time) as last_cons_dh_receive_time_key,
B.shipment_current_status as shipment_current_status,
B.seller_type as seller_type,
B.shipment_dg_flag as shipment_dg_flag,
B.shipment_priority_flag as shipment_priority_flag,
B.service_tier as service_tier,
B.surface_mandatory_flag as surface_mandatory_flag,
B.ekl_shipment_type as ekl_shipment_type,
B.reverse_shipment_type as reverse_shipment_type,
B.number_of_hops as number_of_hops,
B.number_of_air_hops as number_of_air_hops,
B.ekl_fin_zone as ekl_fin_zone,
B.ekart_lzn_flag as ekart_lzn_flag,
B.shipment_fa_flag as shipment_fa_flag,
B.shipment_carrier as shipment_carrier,
B.shipment_rvp_pk_number_of_attempts as shipment_rvp_pk_number_of_attempts,
B.fsd_number_of_ofd_attempts as fsd_number_of_ofd_attempts,
B.shipment_value as shipment_value,
B.vendor_id_key as vendor_id_key,
B.seller_id_key as seller_id_key,
B.primary_product_key as primary_product_key,
B.source_pincode_key as source_pincode_key,
B.destination_pincode_key as destination_pincode_key,
B.customer_address_id_key as customer_address_id_key,
B.vendor_service_type as vendor_service_type,
B.shipment_first_bag_tracking_id as shipment_first_bag_tracking_id,
B.shipment_last_bag_tracking_id as shipment_last_bag_tracking_id,
B.shipment_first_consignment_id as shipment_first_consignment_id,
B.shipment_last_consignment_id as shipment_last_consignment_id,
B.shipment_last_bag_status as shipment_last_bag_status,
B.shipment_last_consignment_status as shipment_last_consignment_status,
B.misroute_flag as misroute_flag,
B.customer_misroute_flag as customer_misroute_flag,
B.profiler_flag as profiler_flag,
B.shipment_origin_facility_id_key as shipment_origin_facility_id_key,
B.shipment_origin_mh_facility_id_key as shipment_origin_mh_facility_id_key,
B.shipment_destination_mh_facility_id_key as shipment_destination_mh_facility_id_key,
B.shipment_destination_facility_id_key as shipment_destination_facility_id_key,
B.shipment_first_received_dh_id_key as shipment_first_received_dh_id_key,
B.shipment_last_received_dh_id_key as shipment_last_received_dh_id_key,
B.shipment_first_received_pc_id_key as shipment_first_received_pc_id_key,
B.shipment_last_received_pc_id_key as shipment_last_received_pc_id_key,
B.shipment_first_received_hub_id_key as shipment_first_received_hub_id_key,
B.shipment_last_received_hub_id_key as shipment_last_received_hub_id_key,
B.shipment_first_received_mh_id_key as shipment_first_received_mh_id_key,
B.shipment_last_received_mh_id_key as shipment_last_received_mh_id_key,
B.fsd_assigned_hub_id_key as fsd_assigned_hub_id_key,
B.reverse_pickup_hub_id_key as reverse_pickup_hub_id_key,
B.shipment_current_hub_id_key as shipment_current_hub_id_key,
B.shipment_current_hub_type as shipment_current_hub_type,
B.shipment_last_consignment_source_hub_id_key as shipment_last_consignment_source_hub_id_key,
B.shipment_first_consignment_destination_hub_id_key as shipment_first_consignment_destination_hub_id_key,
B.shipment_last_consignment_destination_hub_id_key as shipment_last_consignment_destination_hub_id_key,
B.shipment_first_bag_created_hub_id_key as shipment_first_bag_created_hub_id_key,
B.shipment_first_bag_final_hub_id_key as shipment_first_bag_final_hub_id_key,
B.shipment_last_bag_created_hub_id_key as shipment_last_bag_created_hub_id_key,
B.shipment_last_bag_final_hub_id_key as shipment_last_bag_final_hub_id_key,
B.shipment_last_bag_hub_id_key as shipment_last_bag_hub_id_key,
B.shipment_created_at_date_key as shipment_created_at_date_key,
B.shipment_created_at_time_key as shipment_created_at_time_key,
B.shipment_delivered_at_date_key as shipment_delivered_at_date_key,
B.shipment_delivered_at_time_key as shipment_delivered_at_time_key,
B.shipment_first_dispatched_to_merchant_date_key as shipment_first_dispatched_to_merchant_date_key,
B.shipment_first_dispatched_to_merchant_time_key as shipment_first_dispatched_to_merchant_time_key,
B.fsd_last_update_date_key as fsd_last_update_date_key,
B.fsd_last_update_time_key as fsd_last_update_time_key,
B.fsd_first_dh_received_date_key as fsd_first_dh_received_date_key,
B.fsd_first_dh_received_time_key as fsd_first_dh_received_time_key,
B.fsd_last_dh_received_date_key as fsd_last_dh_received_date_key,
B.fsd_last_dh_received_time_key as fsd_last_dh_received_time_key,
B.shipment_first_received_pc_date_key as shipment_first_received_pc_date_key,
B.shipment_first_received_pc_time_key as shipment_first_received_pc_time_key,
B.shipment_last_received_pc_date_key as shipment_last_received_pc_date_key,
B.shipment_last_received_pc_time_key as shipment_last_received_pc_time_key,
B.fsd_first_ofd_date_key as fsd_first_ofd_date_key,
B.fsd_first_ofd_time_key as fsd_first_ofd_time_key,
B.fsd_last_ofd_date_key as fsd_last_ofd_date_key,
B.fsd_last_ofd_time_key as fsd_last_ofd_time_key,
B.shipment_first_rvp_pickup_date_key as shipment_first_rvp_pickup_date_key,
B.shipment_first_rvp_pickup_time_key as shipment_first_rvp_pickup_time_key,
B.shipment_last_rvp_pickup_date_key as shipment_last_rvp_pickup_date_key,
B.shipment_last_rvp_pickup_time_key as shipment_last_rvp_pickup_time_key,
B.order_item_date_key as order_item_date_key,
B.order_item_time_key as order_item_time_key,
B.shipment_first_bag_create_date_key as shipment_first_bag_create_date_key,
B.shipment_first_bag_create_time_key as shipment_first_bag_create_time_key,
B.shipment_first_bag_closed_date_key as shipment_first_bag_closed_date_key,
B.shipment_first_bag_closed_time_key as shipment_first_bag_closed_time_key,
B.shipment_first_bag_reach_date_key as shipment_first_bag_reach_date_key,
B.shipment_first_bag_reach_time_key as shipment_first_bag_reach_time_key,
B.shipment_first_bag_final_received_date_key as shipment_first_bag_final_received_date_key,
B.shipment_first_bag_final_received_time_key as shipment_first_bag_final_received_time_key,
B.shipment_last_bag_create_date_key as shipment_last_bag_create_date_key,
B.shipment_last_bag_create_time_key as shipment_last_bag_create_time_key,
B.shipment_last_bag_close_date_key as shipment_last_bag_close_date_key,
B.shipment_last_bag_close_time_key as shipment_last_bag_close_time_key,
B.shipment_last_bag_reach_date_key as shipment_last_bag_reach_date_key,
B.shipment_last_bag_reach_time_key as shipment_last_bag_reach_time_key,
B.shipment_last_bag_receive_date_key as shipment_last_bag_receive_date_key,
B.shipment_last_bag_receive_time_key as shipment_last_bag_receive_time_key,
B.shipment_first_consignment_create_date_key as shipment_first_consignment_create_date_key,
B.shipment_first_consignment_create_time_key as shipment_first_consignment_create_time_key,
B.shipment_first_consignment_receive_date_key as shipment_first_consignment_receive_date_key,
B.shipment_first_consignment_receive_time_key as shipment_first_consignment_receive_time_key,
B.shipment_last_consignment_create_date_key as shipment_last_consignment_create_date_key,
B.shipment_last_consignment_create_time_key as shipment_last_consignment_create_time_key,
B.shipment_last_consignment_receive_date_key as shipment_last_consignment_receive_date_key,
B.shipment_last_consignment_receive_time_key as shipment_last_consignment_receive_time_key,
B.first_mh_tc_receive_date_key as first_mh_tc_receive_date_key,
B.first_mh_tc_receive_time_key as first_mh_tc_receive_time_key,
B.last_mh_tc_receive_date_key as last_mh_tc_receive_date_key,
B.last_mh_tc_receive_time_key as last_mh_tc_receive_time_key,
B.actual_rvp_pickup_date_key as actual_rvp_pickup_date_key,
B.actual_rvp_pickup_time_key as actual_rvp_pickup_time_key,
B.rto_complete_date_key as rto_complete_date_key,
B.rto_complete_time_key as rto_complete_time_key,
B.customer_dependency_flag as customer_dependency_flag,
B.rto_create_date_key as rto_create_date_key,
B.rto_create_time_key as rto_create_time_key,
B.reverse_complete_date_key as reverse_complete_date_key,
B.reverse_complete_time_key as reverse_complete_time_key
FROM
bigfoot_external_neo.scp_ekl__rto_ship_cons_l2_hive_fact A
left join bigfoot_external_neo.scp_ekl__shipment_hive_90_fact B
ON A.vendor_tracking_id=B.vendor_tracking_id;
